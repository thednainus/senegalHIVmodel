---
title: "Proportion of infected attributable to specific demes"
author: "FabrÃ­cia F. Nascimento"
date: "`r Sys.Date()`"
output:
  rmarkdown::pdf_document:
    fig_caption: true
    df_print: kable
    highlight: pygments
fontsize: 12pt
vignette: >
  %\VignetteIndexEntry{Proportion of infected attributable to specific demes}
  %\VignetteEngine{rmarkdown::render}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
options(knitr.table.format = "latex")
```

# Proportion of infections from one deme attributable to another deme in 2014

All tables below show the median and 95% credible interval for proportion of 
infections from one deme (represented by rows) to another deme (represented
by columns).

## All subtypes

### Model 2

```{r echo = FALSE}
load("data_files/gpm2gpf.rda")
load("data_files/gpf2gpm.rda")
load("data_files/gpf2msm.rda")
load("data_files/msm2gpf.rda")
load("data_files/msm2msm.rda")

#All subtypes combined
#Model 2

gpm2gpf_m2 <- gpm2gpf_All[gpm2gpf_All$Model == "Model 2",]
gpm2gpf_m2["demes"] <- "gpm2gpf"
gpf2gpm_m2 <- gpf2gpm_All[gpf2gpm_All$Model == "Model 2",]
gpf2gpm_m2["demes"] <- "gpf2gpm"
gpf2msm_m2 <- gpf2msm_All[gpf2msm_All$Model == "Model 2",]
gpf2msm_m2["demes"] <- "gpf2msm"
msm2gpf_m2 <- msm2gpf_All[msm2gpf_All$Model == "Model 2",]
msm2gpf_m2["demes"] <- "msm2gpf"
msm2msm_m2 <- msm2msm_All[msm2msm_All$Model == "Model 2",]
msm2msm_m2["demes"] <- "msm2msm"

m2 <- rbind(gpm2gpf_m2, gpf2gpm_m2, gpf2msm_m2, msm2gpf_m2, msm2msm_m2)
m2["CI"] <- paste("(", round(m2$lower,3), "-", round(m2$upper,3), ")", sep="")
m2["proportions"] <- paste(round(m2$median,3), m2$CI, sep=" ")

demes <- c('gpm', 'gpf', 'msm')
m2.m <- matrix('0', nrow = length(demes), ncol = length(demes))
rownames(m2.m) = colnames(m2.m)  <- demes

m2.m["gpm", "gpf"] <- m2$proportions[m2$demes == "gpm2gpf"]
m2.m["gpf", "gpm"] <- m2$proportions[m2$demes == "gpf2gpm"]
m2.m["gpf", "msm"] <- m2$proportions[m2$demes == "gpf2msm"]
m2.m["msm", "gpf"] <- m2$proportions[m2$demes == "msm2gpf"]
m2.m["msm", "msm"] <- m2$proportions[m2$demes == "msm2msm"]


kable_table.m2 <- knitr::kable(m2.m, booktabs = TRUE)
kableExtra::kable_styling(kable_input = kable_table.m2,
                          latex_options = "striped",
                          full_width = FALSE, position = "center")
```

### Model 5 Prevalence (= Model 2)
```{r echo = FALSE}
#All subtypes combined
#Model 5

gpm2gpf_m5 <- gpm2gpf_All[gpm2gpf_All$Model == "Model 5",]
gpm2gpf_m5["demes"] <- "gpm2gpf"
gpf2gpm_m5 <- gpf2gpm_All[gpf2gpm_All$Model == "Model 5",]
gpf2gpm_m5["demes"] <- "gpf2gpm"
gpf2msm_m5 <- gpf2msm_All[gpf2msm_All$Model == "Model 5",]
gpf2msm_m5["demes"] <- "gpf2msm"
msm2gpf_m5 <- msm2gpf_All[msm2gpf_All$Model == "Model 5",]
msm2gpf_m5["demes"] <- "msm2gpf"
msm2msm_m5 <- msm2msm_All[msm2msm_All$Model == "Model 5",]
msm2msm_m5["demes"] <- "msm2msm"

m5 <- rbind(gpm2gpf_m5, gpf2gpm_m5, gpf2msm_m5, msm2gpf_m5, msm2msm_m5)
m5["CI"] <- paste("(", round(m5$lower,3), "-", round(m5$upper,3), ")", sep="")
m5["proportions"] <- paste(round(m5$median,3), m5$CI, sep=" ")

demes <- c('gpm', 'gpf', 'msm')
m5.m <- matrix('0', nrow = length(demes), ncol = length(demes))
rownames(m5.m) = colnames(m5.m)  <- demes

m5.m["gpm", "gpf"] <- m5$proportions[m5$demes == "gpm2gpf"]
m5.m["gpf", "gpm"] <- m5$proportions[m5$demes == "gpf2gpm"]
m5.m["gpf", "msm"] <- m5$proportions[m5$demes == "gpf2msm"]
m5.m["msm", "gpf"] <- m5$proportions[m5$demes == "msm2gpf"]
m5.m["msm", "msm"] <- m5$proportions[m5$demes == "msm2msm"]


kable_table.m5 <- knitr::kable(m5.m, booktabs = TRUE)
kableExtra::kable_styling(kable_input = kable_table.m5,
                          latex_options = "striped",
                          full_width = FALSE, position = "center")

```

### Model 3 
```{r echo = FALSE}
#All subtypes combined
#Model 3

gpm2gpf_m3 <- gpm2gpf_All[gpm2gpf_All$Model == "Model 3",]
gpm2gpf_m3["demes"] <- "gpm2gpf"
gpf2gpm_m3 <- gpf2gpm_All[gpf2gpm_All$Model == "Model 3",]
gpf2gpm_m3["demes"] <- "gpf2gpm"
gpf2msm_m3 <- gpf2msm_All[gpf2msm_All$Model == "Model 3",]
gpf2msm_m3["demes"] <- "gpf2msm"
msm2gpf_m3 <- msm2gpf_All[msm2gpf_All$Model == "Model 3",]
msm2gpf_m3["demes"] <- "msm2gpf"
msm2msm_m3 <- msm2msm_All[msm2msm_All$Model == "Model 3",]
msm2msm_m3["demes"] <- "msm2msm"

m3 <- rbind(gpm2gpf_m3, gpf2gpm_m3, gpf2msm_m3, msm2gpf_m3, msm2msm_m3)
m3["CI"] <- paste("(", round(m3$lower,3), "-", round(m3$upper,3), ")", sep="")
m3["proportions"] <- paste(round(m3$median,3), m3$CI, sep=" ")

demes <- c('gpm', 'gpf', 'msm')
m3.m <- matrix('0', nrow = length(demes), ncol = length(demes))
rownames(m3.m) = colnames(m3.m)  <- demes

m3.m["gpm", "gpf"] <- m3$proportions[m3$demes == "gpm2gpf"]
m3.m["gpf", "gpm"] <- m3$proportions[m3$demes == "gpf2gpm"]
m3.m["gpf", "msm"] <- m3$proportions[m3$demes == "gpf2msm"]
m3.m["msm", "gpf"] <- m3$proportions[m3$demes == "msm2gpf"]
m3.m["msm", "msm"] <- m3$proportions[m3$demes == "msm2msm"]


kable_table.m3 <- knitr::kable(m3.m, booktabs = TRUE)
kableExtra::kable_styling(kable_input = kable_table.m3,
                          latex_options = "striped",
                          full_width = FALSE, position = "center")

```

### Model 6 Prevalence (= Model 3) 
```{r echo = FALSE}
#All subtypes combined
#Model 6

gpm2gpf_m6 <- gpm2gpf_All[gpm2gpf_All$Model == "Model 6",]
gpm2gpf_m6["demes"] <- "gpm2gpf"
gpf2gpm_m6 <- gpf2gpm_All[gpf2gpm_All$Model == "Model 6",]
gpf2gpm_m6["demes"] <- "gpf2gpm"
gpf2msm_m6 <- gpf2msm_All[gpf2msm_All$Model == "Model 6",]
gpf2msm_m6["demes"] <- "gpf2msm"
msm2gpf_m6 <- msm2gpf_All[msm2gpf_All$Model == "Model 6",]
msm2gpf_m6["demes"] <- "msm2gpf"
msm2msm_m6 <- msm2msm_All[msm2msm_All$Model == "Model 6",]
msm2msm_m6["demes"] <- "msm2msm"

m6 <- rbind(gpm2gpf_m6, gpf2gpm_m6, gpf2msm_m6, msm2gpf_m6, msm2msm_m6)
m6["CI"] <- paste("(", round(m6$lower,3), "-", round(m6$upper,3), ")", sep="")
m6["proportions"] <- paste(round(m6$median,3), m6$CI, sep=" ")

demes <- c('gpm', 'gpf', 'msm')
m6.m <- matrix('0', nrow = length(demes), ncol = length(demes))
rownames(m6.m) = colnames(m6.m)  <- demes

m6.m["gpm", "gpf"] <- m6$proportions[m6$demes == "gpm2gpf"]
m6.m["gpf", "gpm"] <- m6$proportions[m6$demes == "gpf2gpm"]
m6.m["gpf", "msm"] <- m6$proportions[m6$demes == "gpf2msm"]
m6.m["msm", "gpf"] <- m6$proportions[m6$demes == "msm2gpf"]
m6.m["msm", "msm"] <- m6$proportions[m6$demes == "msm2msm"]


kable_table.m6 <- knitr::kable(m6.m, booktabs = TRUE)
kableExtra::kable_styling(kable_input = kable_table.m6,
                          latex_options = "striped",
                          full_width = FALSE, position = "center")
```

### Model 4
```{r echo = FALSE}
#All subtypes combined
#Model 4

gpm2gpf_m4 <- gpm2gpf_All[gpm2gpf_All$Model == "Model 4",]
gpm2gpf_m4["demes"] <- "gpm2gpf"
gpf2gpm_m4 <- gpf2gpm_All[gpf2gpm_All$Model == "Model 4",]
gpf2gpm_m4["demes"] <- "gpf2gpm"
gpf2msm_m4 <- gpf2msm_All[gpf2msm_All$Model == "Model 4",]
gpf2msm_m4["demes"] <- "gpf2msm"
msm2gpf_m4 <- msm2gpf_All[msm2gpf_All$Model == "Model 4",]
msm2gpf_m4["demes"] <- "msm2gpf"
msm2msm_m4 <- msm2msm_All[msm2msm_All$Model == "Model 4",]
msm2msm_m4["demes"] <- "msm2msm"

m4 <- rbind(gpm2gpf_m4, gpf2gpm_m4, gpf2msm_m4, msm2gpf_m4, msm2msm_m4)
m4["CI"] <- paste("(", round(m4$lower,3), "-", round(m4$upper,3), ")", sep="")
m4["proportions"] <- paste(round(m4$median,3), m4$CI, sep=" ")

demes <- c('gpm', 'gpf', 'msm')
m4.m <- matrix('0', nrow = length(demes), ncol = length(demes))
rownames(m4.m) = colnames(m4.m)  <- demes

m4.m["gpm", "gpf"] <- m4$proportions[m4$demes == "gpm2gpf"]
m4.m["gpf", "gpm"] <- m4$proportions[m4$demes == "gpf2gpm"]
m4.m["gpf", "msm"] <- m4$proportions[m4$demes == "gpf2msm"]
m4.m["msm", "gpf"] <- m4$proportions[m4$demes == "msm2gpf"]
m4.m["msm", "msm"] <- m4$proportions[m4$demes == "msm2msm"]


kable_table.m4 <- knitr::kable(m4.m, booktabs = TRUE)
kableExtra::kable_styling(kable_input = kable_table.m4,
                          latex_options = "striped",
                          full_width = FALSE, position = "center")
```

### Model 7 Prevalence (= Model 4) 
```{r echo = FALSE}

#All subtypes combined
#Model 7

gpm2gpf_m7 <- gpm2gpf_All[gpm2gpf_All$Model == "Model 7",]
gpm2gpf_m7["demes"] <- "gpm2gpf"
gpf2gpm_m7 <- gpf2gpm_All[gpf2gpm_All$Model == "Model 7",]
gpf2gpm_m7["demes"] <- "gpf2gpm"
gpf2msm_m7 <- gpf2msm_All[gpf2msm_All$Model == "Model 7",]
gpf2msm_m7["demes"] <- "gpf2msm"
msm2gpf_m7 <- msm2gpf_All[msm2gpf_All$Model == "Model 7",]
msm2gpf_m7["demes"] <- "msm2gpf"
msm2msm_m7 <- msm2msm_All[msm2msm_All$Model == "Model 7",]
msm2msm_m7["demes"] <- "msm2msm"

m7 <- rbind(gpm2gpf_m7, gpf2gpm_m7, gpf2msm_m7, msm2gpf_m7, msm2msm_m7)
m7["CI"] <- paste("(", round(m7$lower,3), "-", round(m7$upper,3), ")", sep="")
m7["proportions"] <- paste(round(m7$median,3), m7$CI, sep=" ")

demes <- c('gpm', 'gpf', 'msm')
m7.m <- matrix('0', nrow = length(demes), ncol = length(demes))
rownames(m7.m) = colnames(m7.m)  <- demes

m7.m["gpm", "gpf"] <- m7$proportions[m7$demes == "gpm2gpf"]
m7.m["gpf", "gpm"] <- m7$proportions[m7$demes == "gpf2gpm"]
m7.m["gpf", "msm"] <- m7$proportions[m7$demes == "gpf2msm"]
m7.m["msm", "gpf"] <- m7$proportions[m7$demes == "msm2gpf"]
m7.m["msm", "msm"] <- m7$proportions[m7$demes == "msm2msm"]


kable_table.m7 <- knitr::kable(m7.m, booktabs = TRUE)
kableExtra::kable_styling(kable_input = kable_table.m7,
                          latex_options = "striped",
                          full_width = FALSE, position = "center")
```



## Subtype C

### Subtype C: Model 1

```{r echo = FALSE}

#Subtype C
# Model 1

gpm2gpf_Cm1 <- gpm2gpf_C[gpm2gpf_C$Model == "Model 1",]
gpm2gpf_Cm1["demes"] <- "gpm2gpf"
gpf2gpm_Cm1 <- gpf2gpm_C[gpf2gpm_C$Model == "Model 1",]
gpf2gpm_Cm1["demes"] <- "gpf2gpm"
gpf2msm_Cm1 <- gpf2msm_C[gpf2msm_C$Model == "Model 1",]
gpf2msm_Cm1["demes"] <- "gpf2msm"
msm2gpf_Cm1 <- msm2gpf_C[msm2gpf_C$Model == "Model 1",]
msm2gpf_Cm1["demes"] <- "msm2gpf"
msm2msm_Cm1 <- msm2msm_C[msm2msm_C$Model == "Model 1",]
msm2msm_Cm1["demes"] <- "msm2msm"

Cm1 <- rbind(gpm2gpf_Cm1, gpf2gpm_Cm1, gpf2msm_Cm1, msm2gpf_Cm1, msm2msm_Cm1)
Cm1["CI"] <- paste("(", round(Cm1$lower,3), "-", round(Cm1$upper,3), ")", sep="")
Cm1["proportions"] <- paste(round(Cm1$median,3), Cm1$CI, sep=" ")

demes <- c('gpm', 'gpf', 'msm')
Cm1.m <- matrix('0', nrow = length(demes), ncol = length(demes))
rownames(Cm1.m) = colnames(Cm1.m)  <- demes

Cm1.m["gpm", "gpf"] <- Cm1$proportions[Cm1$demes == "gpm2gpf"]
Cm1.m["gpf", "gpm"] <- Cm1$proportions[Cm1$demes == "gpf2gpm"]
Cm1.m["gpf", "msm"] <- Cm1$proportions[Cm1$demes == "gpf2msm"]
Cm1.m["msm", "gpf"] <- Cm1$proportions[Cm1$demes == "msm2gpf"]
Cm1.m["msm", "msm"] <- Cm1$proportions[Cm1$demes == "msm2msm"]


kable_table.Cm1 <- knitr::kable(Cm1.m, booktabs = TRUE)
kableExtra::kable_styling(kable_input = kable_table.Cm1,
                          latex_options = "striped",
                          full_width = FALSE, position = "center")
```


### Subtype C: Model 2

```{r echo = FALSE}

#Subtype C
# Model 2

gpm2gpf_Cm2 <- gpm2gpf_C[gpm2gpf_C$Model == "Model 2",]
gpm2gpf_Cm2["demes"] <- "gpm2gpf"
gpf2gpm_Cm2 <- gpf2gpm_C[gpf2gpm_C$Model == "Model 2",]
gpf2gpm_Cm2["demes"] <- "gpf2gpm"
gpf2msm_Cm2 <- gpf2msm_C[gpf2msm_C$Model == "Model 2",]
gpf2msm_Cm2["demes"] <- "gpf2msm"
msm2gpf_Cm2 <- msm2gpf_C[msm2gpf_C$Model == "Model 2",]
msm2gpf_Cm2["demes"] <- "msm2gpf"
msm2msm_Cm2 <- msm2msm_C[msm2msm_C$Model == "Model 2",]
msm2msm_Cm2["demes"] <- "msm2msm"

Cm2 <- rbind(gpm2gpf_Cm2, gpf2gpm_Cm2, gpf2msm_Cm2, msm2gpf_Cm2, msm2msm_Cm2)
Cm2["CI"] <- paste("(", round(Cm2$lower,3), "-", round(Cm2$upper,3), ")", sep="")
Cm2["proportions"] <- paste(round(Cm2$median,3), Cm2$CI, sep=" ")

demes <- c('gpm', 'gpf', 'msm')
Cm2.m <- matrix('0', nrow = length(demes), ncol = length(demes))
rownames(Cm2.m) = colnames(Cm2.m)  <- demes

Cm2.m["gpm", "gpf"] <- Cm2$proportions[Cm2$demes == "gpm2gpf"]
Cm2.m["gpf", "gpm"] <- Cm2$proportions[Cm2$demes == "gpf2gpm"]
Cm2.m["gpf", "msm"] <- Cm2$proportions[Cm2$demes == "gpf2msm"]
Cm2.m["msm", "gpf"] <- Cm2$proportions[Cm2$demes == "msm2gpf"]
Cm2.m["msm", "msm"] <- Cm2$proportions[Cm2$demes == "msm2msm"]


kable_table.Cm2 <- knitr::kable(Cm2.m, booktabs = TRUE)
kableExtra::kable_styling(kable_input = kable_table.Cm2,
                          latex_options = "striped",
                          full_width = FALSE, position = "center")
```

### Subtype C: Model 3 Prevalence

```{r echo = FALSE}
gpm2gpf_Cm3 <- gpm2gpf_C[gpm2gpf_C$Model == "Model 3",]
gpm2gpf_Cm3["demes"] <- "gpm2gpf"
gpf2gpm_Cm3 <- gpf2gpm_C[gpf2gpm_C$Model == "Model 3",]
gpf2gpm_Cm3["demes"] <- "gpf2gpm"
gpf2msm_Cm3 <- gpf2msm_C[gpf2msm_C$Model == "Model 3",]
gpf2msm_Cm3["demes"] <- "gpf2msm"
msm2gpf_Cm3 <- msm2gpf_C[msm2gpf_C$Model == "Model 3",]
msm2gpf_Cm3["demes"] <- "msm2gpf"
msm2msm_Cm3 <- msm2msm_C[msm2msm_C$Model == "Model 3",]
msm2msm_Cm3["demes"] <- "msm2msm"

Cm3 <- rbind(gpm2gpf_Cm3, gpf2gpm_Cm3, gpf2msm_Cm3, msm2gpf_Cm3, msm2msm_Cm3)
Cm3["CI"] <- paste("(", round(Cm3$lower,3), "-", round(Cm3$upper,3), ")", sep="")
Cm3["proportions"] <- paste(round(Cm3$median,3), Cm3$CI, sep=" ")

demes <- c('gpm', 'gpf', 'msm')
Cm3.m <- matrix('0', nrow = length(demes), ncol = length(demes))
rownames(Cm3.m) = colnames(Cm3.m)  <- demes

Cm3.m["gpm", "gpf"] <- Cm3$proportions[Cm3$demes == "gpm2gpf"]
Cm3.m["gpf", "gpm"] <- Cm3$proportions[Cm3$demes == "gpf2gpm"]
Cm3.m["gpf", "msm"] <- Cm3$proportions[Cm3$demes == "gpf2msm"]
Cm3.m["msm", "gpf"] <- Cm3$proportions[Cm3$demes == "msm2gpf"]
Cm3.m["msm", "msm"] <- Cm3$proportions[Cm3$demes == "msm2msm"]


kable_table.Cm3 <- knitr::kable(Cm3.m, booktabs = TRUE)
kableExtra::kable_styling(kable_input = kable_table.Cm3,
                          latex_options = "striped",
                          full_width = FALSE, position = "center")
```

### Subtype C: Model 4 Prevalence

```{r echo = FALSE}
gpm2gpf_Cm4 <- gpm2gpf_C[gpm2gpf_C$Model == "Model 4",]
gpm2gpf_Cm4["demes"] <- "gpm2gpf"
gpf2gpm_Cm4 <- gpf2gpm_C[gpf2gpm_C$Model == "Model 4",]
gpf2gpm_Cm4["demes"] <- "gpf2gpm"
gpf2msm_Cm4 <- gpf2msm_C[gpf2msm_C$Model == "Model 4",]
gpf2msm_Cm4["demes"] <- "gpf2msm"
msm2gpf_Cm4 <- msm2gpf_C[msm2gpf_C$Model == "Model 4",]
msm2gpf_Cm4["demes"] <- "msm2gpf"
msm2msm_Cm4 <- msm2msm_C[msm2msm_C$Model == "Model 4",]
msm2msm_Cm4["demes"] <- "msm2msm"

Cm4 <- rbind(gpm2gpf_Cm4, gpf2gpm_Cm4, gpf2msm_Cm4, msm2gpf_Cm4, msm2msm_Cm4)
Cm4["CI"] <- paste("(", round(Cm4$lower,3), "-", round(Cm4$upper,3), ")", sep="")
Cm4["proportions"] <- paste(round(Cm4$median,3), Cm4$CI, sep=" ")

demes <- c('gpm', 'gpf', 'msm')
Cm4.m <- matrix('0', nrow = length(demes), ncol = length(demes))
rownames(Cm4.m) = colnames(Cm4.m)  <- demes

Cm4.m["gpm", "gpf"] <- Cm4$proportions[Cm4$demes == "gpm2gpf"]
Cm4.m["gpf", "gpm"] <- Cm4$proportions[Cm4$demes == "gpf2gpm"]
Cm4.m["gpf", "msm"] <- Cm4$proportions[Cm4$demes == "gpf2msm"]
Cm4.m["msm", "gpf"] <- Cm4$proportions[Cm4$demes == "msm2gpf"]
Cm4.m["msm", "msm"] <- Cm4$proportions[Cm4$demes == "msm2msm"]


kable_table.Cm4 <- knitr::kable(Cm4.m, booktabs = TRUE)
kableExtra::kable_styling(kable_input = kable_table.Cm4,
                          latex_options = "striped",
                          full_width = FALSE, position = "center")
```

## Subtype 02_AG

### Subtype 02_AG: Model 1
```{r echo = FALSE}

#Subtype AG
# Model 1

gpm2gpf_AGm1 <- gpm2gpf_AG[gpm2gpf_AG$Model == "Model 1",]
gpm2gpf_AGm1["demes"] <- "gpm2gpf"
gpf2gpm_AGm1 <- gpf2gpm_AG[gpf2gpm_AG$Model == "Model 1",]
gpf2gpm_AGm1["demes"] <- "gpf2gpm"
gpf2msm_AGm1 <- gpf2msm_AG[gpf2msm_AG$Model == "Model 1",]
gpf2msm_AGm1["demes"] <- "gpf2msm"
msm2gpf_AGm1 <- msm2gpf_AG[msm2gpf_AG$Model == "Model 1",]
msm2gpf_AGm1["demes"] <- "msm2gpf"
msm2msm_AGm1 <- msm2msm_AG[msm2msm_AG$Model == "Model 1",]
msm2msm_AGm1["demes"] <- "msm2msm"

AGm1 <- rbind(gpm2gpf_AGm1, gpf2gpm_AGm1, gpf2msm_AGm1, msm2gpf_AGm1, msm2msm_AGm1)
AGm1["CI"] <- paste("(", round(AGm1$lower,3), "-", round(AGm1$upper,3), ")", sep="")
AGm1["proportions"] <- paste(round(AGm1$median,3), AGm1$CI, sep=" ")

demes <- c('gpm', 'gpf', 'msm')
AGm1.m <- matrix('0', nrow = length(demes), ncol = length(demes))
rownames(AGm1.m) = colnames(AGm1.m)  <- demes

AGm1.m["gpm", "gpf"] <- AGm1$proportions[AGm1$demes == "gpm2gpf"]
AGm1.m["gpf", "gpm"] <- AGm1$proportions[AGm1$demes == "gpf2gpm"]
AGm1.m["gpf", "msm"] <- AGm1$proportions[AGm1$demes == "gpf2msm"]
AGm1.m["msm", "gpf"] <- AGm1$proportions[AGm1$demes == "msm2gpf"]
AGm1.m["msm", "msm"] <- AGm1$proportions[AGm1$demes == "msm2msm"]


kable_table.AGm1 <- knitr::kable(AGm1.m, booktabs = TRUE)
kableExtra::kable_styling(kable_input = kable_table.AGm1,
                          latex_options = "striped",
                          full_width = FALSE, position = "center")
```

### Subtype 02_AG: Model 2
```{r echo = FALSE}

#Subtype AG
# Model 2

gpm2gpf_AGm2 <- gpm2gpf_AG[gpm2gpf_AG$Model == "Model 2",]
gpm2gpf_AGm2["demes"] <- "gpm2gpf"
gpf2gpm_AGm2 <- gpf2gpm_AG[gpf2gpm_AG$Model == "Model 2",]
gpf2gpm_AGm2["demes"] <- "gpf2gpm"
gpf2msm_AGm2 <- gpf2msm_AG[gpf2msm_AG$Model == "Model 2",]
gpf2msm_AGm2["demes"] <- "gpf2msm"
msm2gpf_AGm2 <- msm2gpf_AG[msm2gpf_AG$Model == "Model 2",]
msm2gpf_AGm2["demes"] <- "msm2gpf"
msm2msm_AGm2 <- msm2msm_AG[msm2msm_AG$Model == "Model 2",]
msm2msm_AGm2["demes"] <- "msm2msm"

AGm2 <- rbind(gpm2gpf_AGm2, gpf2gpm_AGm2, gpf2msm_AGm2, msm2gpf_AGm2, msm2msm_AGm2)
AGm2["CI"] <- paste("(", round(AGm2$lower,3), "-", round(AGm2$upper,3), ")", sep="")
AGm2["proportions"] <- paste(round(AGm2$median,3), AGm2$CI, sep=" ")

demes <- c('gpm', 'gpf', 'msm')
AGm2.m <- matrix('0', nrow = length(demes), ncol = length(demes))
rownames(AGm2.m) = colnames(AGm2.m)  <- demes

AGm2.m["gpm", "gpf"] <- AGm2$proportions[AGm2$demes == "gpm2gpf"]
AGm2.m["gpf", "gpm"] <- AGm2$proportions[AGm2$demes == "gpf2gpm"]
AGm2.m["gpf", "msm"] <- AGm2$proportions[AGm2$demes == "gpf2msm"]
AGm2.m["msm", "gpf"] <- AGm2$proportions[AGm2$demes == "msm2gpf"]
AGm2.m["msm", "msm"] <- AGm2$proportions[AGm2$demes == "msm2msm"]


kable_table.AGm2 <- knitr::kable(AGm2.m, booktabs = TRUE)
kableExtra::kable_styling(kable_input = kable_table.AGm2,
                          latex_options = "striped",
                          full_width = FALSE, position = "center")
```

### Subtype 02_AG: Model 3 Prevalece
```{r echo = FALSE}

#Subtype AG
# Model 3

gpm2gpf_AGm3 <- gpm2gpf_AG[gpm2gpf_AG$Model == "Model 3",]
gpm2gpf_AGm3["demes"] <- "gpm2gpf"
gpf2gpm_AGm3 <- gpf2gpm_AG[gpf2gpm_AG$Model == "Model 3",]
gpf2gpm_AGm3["demes"] <- "gpf2gpm"
gpf2msm_AGm3 <- gpf2msm_AG[gpf2msm_AG$Model == "Model 3",]
gpf2msm_AGm3["demes"] <- "gpf2msm"
msm2gpf_AGm3 <- msm2gpf_AG[msm2gpf_AG$Model == "Model 3",]
msm2gpf_AGm3["demes"] <- "msm2gpf"
msm2msm_AGm3 <- msm2msm_AG[msm2msm_AG$Model == "Model 3",]
msm2msm_AGm3["demes"] <- "msm2msm"

AGm3 <- rbind(gpm2gpf_AGm3, gpf2gpm_AGm3, gpf2msm_AGm3, msm2gpf_AGm3, msm2msm_AGm3)
AGm3["CI"] <- paste("(", round(AGm3$lower,3), "-", round(AGm3$upper,3), ")", sep="")
AGm3["proportions"] <- paste(round(AGm3$median,3), AGm3$CI, sep=" ")

demes <- c('gpm', 'gpf', 'msm')
AGm3.m <- matrix('0', nrow = length(demes), ncol = length(demes))
rownames(AGm3.m) = colnames(AGm3.m)  <- demes

AGm3.m["gpm", "gpf"] <- AGm3$proportions[AGm3$demes == "gpm2gpf"]
AGm3.m["gpf", "gpm"] <- AGm3$proportions[AGm3$demes == "gpf2gpm"]
AGm3.m["gpf", "msm"] <- AGm3$proportions[AGm3$demes == "gpf2msm"]
AGm3.m["msm", "gpf"] <- AGm3$proportions[AGm3$demes == "msm2gpf"]
AGm3.m["msm", "msm"] <- AGm3$proportions[AGm3$demes == "msm2msm"]


kable_table.AGm3 <- knitr::kable(AGm3.m, booktabs = TRUE)
kableExtra::kable_styling(kable_input = kable_table.AGm3,
                          latex_options = "striped",
                          full_width = FALSE, position = "center")
```

### Subtype 02_AG: Model 4 Prevalence
```{r echo = FALSE}

#Subtype AG
# Model 4

gpm2gpf_AGm4 <- gpm2gpf_AG[gpm2gpf_AG$Model == "Model 4",]
gpm2gpf_AGm4["demes"] <- "gpm2gpf"
gpf2gpm_AGm4 <- gpf2gpm_AG[gpf2gpm_AG$Model == "Model 4",]
gpf2gpm_AGm4["demes"] <- "gpf2gpm"
gpf2msm_AGm4 <- gpf2msm_AG[gpf2msm_AG$Model == "Model 4",]
gpf2msm_AGm4["demes"] <- "gpf2msm"
msm2gpf_AGm4 <- msm2gpf_AG[msm2gpf_AG$Model == "Model 4",]
msm2gpf_AGm4["demes"] <- "msm2gpf"
msm2msm_AGm4 <- msm2msm_AG[msm2msm_AG$Model == "Model 4",]
msm2msm_AGm4["demes"] <- "msm2msm"

AGm4 <- rbind(gpm2gpf_AGm4, gpf2gpm_AGm4, gpf2msm_AGm4, msm2gpf_AGm4, msm2msm_AGm4)
AGm4["CI"] <- paste("(", round(AGm4$lower,3), "-", round(AGm4$upper,3), ")", sep="")
AGm4["proportions"] <- paste(round(AGm4$median,3), AGm4$CI, sep=" ")

demes <- c('gpm', 'gpf', 'msm')
AGm4.m <- matrix('0', nrow = length(demes), ncol = length(demes))
rownames(AGm4.m) = colnames(AGm4.m)  <- demes

AGm4.m["gpm", "gpf"] <- AGm4$proportions[AGm4$demes == "gpm2gpf"]
AGm4.m["gpf", "gpm"] <- AGm4$proportions[AGm4$demes == "gpf2gpm"]
AGm4.m["gpf", "msm"] <- AGm4$proportions[AGm4$demes == "gpf2msm"]
AGm4.m["msm", "gpf"] <- AGm4$proportions[AGm4$demes == "msm2gpf"]
AGm4.m["msm", "msm"] <- AGm4$proportions[AGm4$demes == "msm2msm"]


kable_table.AGm4 <- knitr::kable(AGm4.m, booktabs = TRUE)
kableExtra::kable_styling(kable_input = kable_table.AGm4,
                          latex_options = "striped",
                          full_width = FALSE, position = "center")
```
